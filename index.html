<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>潮玩角色闪卡系统 - MVP 演示</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700&family=Noto+Sans+SC:wght@400;500;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div class="page">
    <header class="topbar">
      <div class="brand">
        <span class="brand__dot">LM</span>
        <div>
          <h1>Memory Trainer</h1>
          <p>潮玩角色闪卡</p>
        </div>
      </div>
      <div class="topbar__actions">
        <button class="btn ghost" data-panel-trigger="upload">导入图片</button>
        <button class="btn ghost" data-panel-trigger="groups">管理卡牌组</button>
        <button class="btn ghost" data-panel-trigger="auth">登录 / 注册</button>
        <button class="btn" data-panel-trigger="sync">云端同步</button>
      </div>
    </header>

    <main>
      <section class="collection">
        <div class="collection__head">
          <div>
            <h2>卡牌列表</h2>
            <p>框选角色后生成卡片，编辑名称与简介并进入训练。</p>
          </div>
          <div class="collection__actions">
            <button class="btn primary" id="confirm-all">批量确认</button>
            <button class="btn ghost" id="reset-cards">重置草稿</button>
          </div>
        </div>
        <div class="card-grid" id="card-grid"></div>
      </section>

      <section class="training" id="training">
        <div class="section-head">
          <h2>记忆训练</h2>
          <p>翻转卡片训练记忆，支持随机与错题集。</p>
        </div>
        <div class="training__layout">
          <div class="flashcard" id="flashcard">
            <div class="flashcard__side flashcard__front">
              <div class="flashcard__image" id="flash-image"></div>
              <span class="flashcard__tip">点击翻面</span>
            </div>
            <div class="flashcard__side flashcard__back">
              <h3 id="flash-name">角色名称</h3>
              <p id="flash-desc">角色简介将显示在这里，支持从 OCR 或角色库自动生成。</p>
              <div class="flashcard__meta" id="flash-tag">卡片未确认</div>
            </div>
          </div>
          <div class="training__controls">
            <div class="control-group">
              <label>训练模式</label>
              <div class="segmented" id="mode-segment">
                <button class="segmented__btn is-active" data-order="sequence">顺序</button>
                <button class="segmented__btn" data-order="random">随机</button>
                <button class="segmented__btn" data-order="mistake">错题集</button>
              </div>
            </div>
            <div class="control-group">
              <label>操作</label>
              <div class="control-actions">
                <button class="btn ghost" id="prev-card">上一张</button>
                <button class="btn primary" id="next-card">下一张</button>
              </div>
            </div>
            <div class="control-group">
              <label>复习状态</label>
              <div class="status-box" id="status-box">已完成 0 / 0</div>
              <div class="status-actions">
                <button class="btn tiny" id="mark-known">记住了</button>
                <button class="btn tiny ghost" id="mark-unknown">不熟悉</button>
              </div>
            </div>
          </div>
        </div>
      </section>
    </main>
  </div>

  <div class="panel-overlay" id="panel-overlay"></div>

  <aside class="panel" id="panel-upload" data-panel="upload">
    <div class="panel__header">
      <h3>导入图片</h3>
      <button class="btn ghost panel__close" data-panel-close>关闭</button>
    </div>
    <div class="panel__body">
      <div class="mode-switch" role="tablist" aria-label="图片模式">
        <button class="mode-switch__btn is-active" role="tab" data-mode="poster">多角色海报</button>
        <button class="mode-switch__btn" role="tab" data-mode="single">单角色图片</button>
      </div>
      <div class="dropzone" id="dropzone">
        <input type="file" accept="image/*" id="file-input" />
        <div class="dropzone__content">
          <p class="dropzone__title">拖拽图片到此处</p>
          <p class="dropzone__hint">或点击选择文件 · 支持 JPG / PNG</p>
        </div>
      </div>
      <div class="auto-detect">
        <span class="auto-detect__label">自动检测结果</span>
        <span class="pill" id="detect-pill">等待图片</span>
      </div>
      <div class="pipeline">
        <div class="pipeline__step is-active"><span>1</span> 图像解析</div>
        <div class="pipeline__step"><span>2</span> 角色检测</div>
        <div class="pipeline__step"><span>3</span> 卡片草稿</div>
      </div>
      <div class="ocr-panel">
        <div class="ocr-panel__head">
          <span>OCR 识别</span>
          <span class="pill" id="ai-status">待机</span>
        </div>
        <div class="ocr-panel__body" id="ocr-text">等待识别</div>
      </div>
      <div class="preview-card">
        <img id="preview-image" alt="预览" />
        <div class="preview-card__overlay" id="crop-overlay"></div>
      </div>
      <div class="preview-note">
        <p>先拖拽框选角色，再点击“确认框选”生成角色卡片。</p>
      </div>
      <div class="preview-actions">
        <button class="btn primary" id="generate-cards">确认框选</button>
        <button class="btn ghost" id="mock-generate">生成草稿</button>
      </div>
    </div>
  </aside>

  <aside class="panel" id="panel-auth" data-panel="auth">
    <div class="panel__header">
      <h3>登录与注册</h3>
      <button class="btn ghost panel__close" data-panel-close>关闭</button>
    </div>
    <div class="panel__body">
      <label for="auth-email">邮箱</label>
      <input id="auth-email" type="email" placeholder="name@example.com" />
      <label for="auth-password">密码</label>
      <input id="auth-password" type="password" placeholder="至少 6 位" />
      <div class="auth__actions">
        <button class="btn primary" id="sign-up">注册</button>
        <button class="btn" id="sign-in">登录</button>
        <button class="btn" id="sign-in-github">GitHub 登录</button>
        <button class="btn ghost" id="sign-out">退出</button>
      </div>
      <div class="auth__status" id="auth-status">未登录</div>
    </div>
  </aside>

  <aside class="panel" id="panel-sync" data-panel="sync">
    <div class="panel__header">
      <h3>云端同步</h3>
      <button class="btn ghost panel__close" data-panel-close>关闭</button>
    </div>
    <div class="panel__body">
      <p class="auth__hint">保存后可在其他设备继续练习。</p>
      <div class="auth__actions">
        <button class="btn primary" id="sync-save">保存到云端</button>
        <button class="btn ghost" id="sync-load">从云端加载</button>
      </div>
      <div class="auth__status" id="sync-status">等待操作</div>
    </div>
  </aside>

  <aside class="panel" id="panel-groups" data-panel="groups">
    <div class="panel__header">
      <h3>卡牌组</h3>
      <button class="btn ghost panel__close" data-panel-close>关闭</button>
    </div>
    <div class="panel__body">
      <div class="group-panel">
        <div class="group-panel__head">
          <h3>卡牌组</h3>
          <span class="group-status" id="group-status">请选择或创建组</span>
        </div>
        <div class="group-panel__row">
          <label for="group-select">选择组</label>
          <select id="group-select"></select>
        </div>
        <div class="group-panel__row">
          <label for="group-name">新建组</label>
          <div class="group-panel__actions">
            <input id="group-name" type="text" placeholder="新建卡牌组名称" />
            <button class="btn" id="create-group">创建组</button>
          </div>
        </div>
        <div class="group-panel__row">
          <label for="group-rename">修改名称</label>
          <div class="group-panel__actions">
            <input id="group-rename" type="text" placeholder="输入新名称" />
            <button class="btn ghost" id="rename-group">保存名称</button>
          </div>
        </div>
      </div>
    </div>
  </aside>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="app.js"></script>
</body>
</html>
